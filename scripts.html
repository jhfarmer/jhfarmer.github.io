<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Scripts & Automation - James Farmer</title>
  <meta name="description" content="Scripts and automation snippets by James Farmer: PowerShell, Python, Intune, AD, VMware." />
  <meta name="theme-color" content="#0f172a" />
  <style>
    :root{--bg:#0b1020;--panel:#0f172a;--muted:#94a3b8;--ink:#e5e7eb;--brand:#7c3aed;--brand-2:#22d3ee;--ring:#7c3aed60;--chip:#11182780}
    @media (prefers-color-scheme: light){:root{--bg:#f8fafc;--panel:#ffffff;--muted:#475569;--ink:#0f172a;--ring:#7c3aed30;--chip:#e5e7eb}}
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;font:16px/1.6 system-ui,Segoe UI,Inter,Roboto,Arial;background:
      radial-gradient(1200px 600px at 90% -10%, #1e293b 0%, transparent 60%),
      radial-gradient(800px 400px at -10% 10%, #0b3b52 0%, transparent 55%),var(--bg);
      color:var(--ink)}
    a{color:inherit;text-decoration:none}
    .container{max-width:1000px;margin:auto;padding:2rem}
    header.sticky{position:sticky;top:0;z-index:30;backdrop-filter:saturate(160%) blur(8px);
      background:color-mix(in oklab, var(--panel) 90%, transparent);border-bottom:1px solid color-mix(in oklab,var(--muted), transparent 70%)}
    .nav{display:flex;align-items:center;justify-content:space-between;padding:.75rem 1rem}
    .logo{display:flex;align-items:center;gap:.6rem;font-weight:700}
    .badge{display:inline-flex;align-items:center;gap:.35rem;padding:.35rem .6rem;border-radius:999px;background:var(--chip);border:1px solid color-mix(in oklab,var(--muted), transparent 70%)}
    .btn{display:inline-flex;align-items:center;gap:.5rem;padding:.6rem .9rem;border-radius:12px;font-weight:600;border:1px solid color-mix(in oklab,var(--brand),white 70%);background:transparent}
    .btn:hover{box-shadow:0 0 0 6px var(--ring)}
    .section{margin-top:2rem}
    h1{font-size:clamp(1.6rem,4vw,2.2rem);line-height:1.15;margin:.3rem 0 .5rem}
    .kicker{color:var(--brand-2);font-weight:600;letter-spacing:.2em;text-transform:uppercase;font-size:.75rem}
    .panel{background:color-mix(in oklab,var(--panel), black 6%);border:1px solid color-mix(in oklab,var(--muted), transparent 70%);border-radius:18px;padding:1rem}
    .grid{display:grid;gap:1rem}
    @media(min-width:760px){.grid.cols-2{grid-template-columns:repeat(2,1fr)}}
    .item{background:color-mix(in oklab,var(--panel), black 6%);border:1px solid color-mix(in oklab,var(--muted), transparent 70%);border-radius:16px;padding:1rem}
    .item h3{margin:.1rem 0 .4rem}
    .muted{color:var(--muted)}
    ul.list{display:grid;gap:.65rem;margin:.6rem 0 0 1.1rem}
    footer{margin:3rem 0 2rem;text-align:center;color:var(--muted)}
  </style>
</head>
<body>
  <header class="sticky">
    <nav class="nav container">
      <a class="logo" href="index.html" aria-label="Back to main portfolio">
        <svg width="26" height="26" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M12 2l8 4.5v10.9L12 22l-8-4.6V6.5L12 2z" stroke="currentColor" stroke-width="1.5"/></svg>
        <span>James&nbsp;Farmer</span>
      </a>
      <div class="cta">
        <a class="badge" href="mailto:james@jhfarmer.com">james@jhfarmer.com</a>
        <a class="badge" href="https://linkedin.com/in/james-farmer-040a32182/" target="_blank" rel="noopener" title="View LinkedIn">
          <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M4.98 3.5A2.5 2.5 0 1 0 5 8.5a2.5 2.5 0 0 0 0-5zM3 9h4v12H3zM9 9h4v1.9h.06c.56-1.06 1.94-2.18 4-2.18 4.28 0 5.07 2.82 5.07 6.48V21h-4v-5.4c0-1.29-.02-2.95-1.8-2.95-1.8 0-2.08 1.4-2.08 2.85V21H9z"/></svg>
          <span>LinkedIn</span>
        </a>
      </div>
    </nav>
  </header>

  <main class="container">
    <section class="section panel">
      <span class="kicker">Sub‑page</span>
      <h1>Scripts & Automation</h1>
      <p class="muted">Selected operational scripts I’ve built.</p>
    </section>

    <section class="section">
      <div class="grid cols-2">
        <article class="item">
          <h3>PowerShell</h3>
          <p class="muted">Cloud + infra operations with safety rails and logging.</p>

          <details class="exp">
            <summary><strong>Intune device cleanup & compliance helpers</strong><span class="muted"> - find stale devices (90+ days) and retire them</span></summary>
            <pre><code class="language-powershell"># Requires: Microsoft.Graph modules
# Install-Module Microsoft.Graph -Scope CurrentUser
# Connect with least-privilege scopes
Connect-MgGraph -Scopes "DeviceManagementManagedDevices.ReadWrite.All"

$cutoff = (Get-Date).AddDays(-90).ToString('o')

$stale = Get-MgDeviceManagementManagedDevice -Filter "lastSyncDateTime lt $cutoff" -All

$stale | Select-Object deviceName, userPrincipalName, lastSyncDateTime |
  Sort-Object lastSyncDateTime | Format-Table -AutoSize

# Review before retiring. Remove -WhatIf to execute.
foreach($d in $stale){
  Write-Host "Retiring" $d.deviceName -ForegroundColor Yellow
  Invoke-MgDeviceManagementManagedDeviceRetire -ManagedDeviceId $d.Id -WhatIf
}
</code></pre>
            <p class="muted">Tip: swap <code>Retire</code> with <code>Wipe</code> only when you're absolutely sure. Consider exporting the list to CSV before acting.</p>
          </details>

          <details class="exp">
            <summary><strong>Zero‑touch offboarding (Batch CSV + transcripts)</strong><span class="muted"> - Entra ID + AD + EXO with idempotency</span></summary>
            <pre><code class="language-powershell"># PowerShell 7+ recommended
# Modules: Microsoft.Graph, ExchangeOnlineManagement, ActiveDirectory
# CSV columns (example): UPN, DisabledOU, KeepGroups (semicolon-delimited)

param(
  [Parameter(Mandatory)] [string]$CsvPath,
  [string]$TranscriptDir = "./transcripts",
  [switch]$WhatIf
)

$ErrorActionPreference = 'Stop'
$null = New-Item -ItemType Directory -Path $TranscriptDir -Force -ErrorAction SilentlyContinue
$logPath = Join-Path $TranscriptDir ("offboarding-" + (Get-Date -Format yyyyMMddHHmmss) + ".log")

function Write-Log([string]$msg){ $stamp = (Get-Date).ToString('s'); "$stamp`t$msg" | Tee-Object -FilePath $logPath -Append }

Import-Module ActiveDirectory
Connect-MgGraph -Scopes "User.ReadWrite.All, Directory.AccessAsUser.All" | Out-Null
Connect-ExchangeOnline -ShowBanner:$false | Out-Null

$rows = Import-Csv -Path $CsvPath
foreach($row in $rows){
  $upn = $row.UPN.Trim()
  $disabledOU = $row.DisabledOU
  $keep = @($row.KeepGroups -split ';' | ForEach-Object { $_.Trim() } | Where-Object { $_ })
  $xname = $upn.Replace('@','_')
  $tfile = Join-Path $TranscriptDir ("$xname-" + (Get-Date -Format yyyyMMddHHmmss) + ".txt")
  Start-Transcript -Path $tfile | Out-Null
  try{
    Write-Log "Starting offboarding for $upn"

    # Idempotency marker (Entra extension property)
    $mgUser = Get-MgUser -UserId $upn -Property id,accountEnabled,extension_Offboarded -ErrorAction Stop
    if($mgUser.AdditionalProperties.ContainsKey('extension_Offboarded') -and $mgUser.AdditionalProperties['extension_Offboarded'] -eq $true){
      Write-Log "SKIP: Already offboarded (marker set) for $upn"; continue
    }

    if(-not $WhatIf){ Update-MgUser -UserId $mgUser.Id -AccountEnabled:$false }
    Revoke-MgUserSignInSession -UserId $mgUser.Id | Out-Null

    if(-not $WhatIf){ Set-Mailbox -Identity $upn -Type Shared -IgnoreDefaultScope:$true -ErrorAction SilentlyContinue }
    if(-not $WhatIf){ Set-Mailbox -Identity $upn -LitigationHoldEnabled:$true -RetentionComment "Offboarding hold" }

    $adUser = Get-ADUser -Filter { UserPrincipalName -eq $upn } -Properties memberOf,DistinguishedName
    if($adUser){
      if(-not $WhatIf){ Disable-ADAccount -Identity $adUser }
      if($disabledOU -and $adUser.DistinguishedName -notmatch [regex]::Escape($disabledOU)){
        if(-not $WhatIf){ Move-ADObject -Identity $adUser.DistinguishedName -TargetPath $disabledOU }
      }
      $current = @()
      if($adUser.memberOf){ $current = $adUser.memberOf | ForEach-Object { (Get-ADGroup $_).Name } }
      $remove = $current | Where-Object { $_ -notin $keep -and $_ -ne 'Domain Users' }
      foreach($g in $remove){ if(-not $WhatIf){ Remove-ADGroupMember -Identity $g -Members $adUser.SamAccountName -Confirm:$false } }
    }

    if(-not $WhatIf){ Update-MgUser -UserId $mgUser.Id -AdditionalProperties @{ extension_Offboarded = $true } }

    Write-Log "SUCCESS: Offboarded $upn"
  }
  catch{ Write-Log "ERROR for $upn: $($_.Exception.Message)" }
  finally{ Stop-Transcript | Out-Null }
}

Write-Log "All rows processed. Log: $logPath"</code></pre>
            <p class="muted">Batch processing with per-user transcripts, logging, and an Entra extension property as an idempotency marker. Supports <code>-WhatIf</code>.</p>
          </details>

          <details class="exp">
            <summary><strong>vSphere golden image deploy (parallel + IPAM)</strong><span class="muted"> - CSV or count, tags, Tools wait, idempotent</span></summary>
            <pre><code class="language-powershell"># PowerShell 7+ recommended (ForEach-Object -Parallel)
# Requires: VMware.PowerCLI 13+

param(
  [string]$CsvPath,                 # CSV columns: Name,Template,CustomizationSpec,Cluster,Datastore,Network,Folder,TagsJSON
  [string]$NamePrefix = "WIN11-",
  [int]$Count = 0,                  # used when CsvPath not provided
  [string]$Template = "Win11-Golden",
  [string]$CustomizationSpec = "Win11-JoinDomain",
  [string]$ClusterName = "Prod-Cluster",
  [string]$DatastoreName = "DS_Tier1",
  [string]$NetworkName = "Corp-LAN",
  [string]$FolderName = "VDI",
  [string]$IpamBase = "https://ipam.example/api/",
  [string]$IpamToken = "",
  [int]$MaxParallel = 4
)

function Request-IpamReservation([string]$name){
  if([string]::IsNullOrEmpty($IpamToken)){ return $null }
  try{
    $hdr = @{ Authorization = "Bearer $IpamToken" }
    $resp = Invoke-RestMethod -Method Post -Uri (Join-Path $IpamBase 'reserve') -Headers $hdr -Body (@{ hostname=$name } | ConvertTo-Json) -ContentType 'application/json'
    return $resp
  } catch { Write-Warning "IPAM reservation failed for $name: $($_.Exception.Message)"; return $null }
}

$cluster = Get-Cluster -Name $ClusterName -ErrorAction Stop
$ds      = Get-Datastore -Name $DatastoreName -ErrorAction Stop
$folder  = Get-Folder -Name $FolderName -Type VM -ErrorAction Stop

$work = @()
if($CsvPath){
  $work = Import-Csv -Path $CsvPath
}else{
  1..$Count | ForEach-Object { $work += [pscustomobject]@{ Name=("{0}{1:D3}" -f $NamePrefix,$_); Template=$Template; CustomizationSpec=$CustomizationSpec; Cluster=$ClusterName; Datastore=$DatastoreName; Network=$NetworkName; Folder=$FolderName; TagsJSON='{"env":"prod","owner":"it"}' } }
}

$script = {
  param($item, $NetworkName)
  $name=$item.Name; $tmpl=$item.Template; $cust=$item.CustomizationSpec

  if(Get-VM -Name $name -ErrorAction SilentlyContinue){ Write-Host "SKIP (exists): $name"; return }

  $null = Request-IpamReservation -name $name  # optional

  $vm = New-VM -Name $name -Template $tmpl -Datastore (Get-Datastore -Name $item.Datastore) -Location (Get-Folder -Name $item.Folder -Type VM) -Confirm:$false
  Get-NetworkAdapter -VM $vm | Set-NetworkAdapter -NetworkName $NetworkName -Confirm:$false | Out-Null
  if($cust){ Set-VM -VM $vm -OSCustomizationSpec $cust -Confirm:$false | Out-Null }
  Start-VM -VM $vm -Confirm:$false | Out-Null

  $ok = Wait-Tools -VM $vm -TimeoutSeconds 900 -ErrorAction SilentlyContinue
  if(-not $ok){ Write-Warning "$name tools timeout" }

  $tags = @{}; if($item.TagsJSON){ $tags = $item.TagsJSON | ConvertFrom-Json }
  foreach($k in $tags.Keys){
    $cat = Get-TagCategory -Name $k -ErrorAction SilentlyContinue
    if(-not $cat){ $cat = New-TagCategory -Name $k -Cardinality Single -EntityType VirtualMachine }
    $tag = Get-Tag -Name $tags[$k] -Category $cat -ErrorAction SilentlyContinue
    if(-not $tag){ $tag = New-Tag -Name $tags[$k] -Category $cat }
    New-TagAssignment -Entity $vm -Tag $tag | Out-Null
  }
  Set-Annotation -Entity $vm -CustomAttribute "BuildId" -Value (Get-Date -Format yyyyMMddHHmmss) -ErrorAction SilentlyContinue
  Write-Host "OK: $name"
}

$opts = @{ ThrottleLimit = $MaxParallel }
$work | ForEach-Object -Parallel $script -ArgumentList $NetworkName @opts

Write-Host "Deployment finished." -ForegroundColor Green</code></pre>
            <p class="muted">Parallel clones, CSV/parameter input, optional IPAM reservation, skip-if-exists, and tags/annotations as idempotency markers.</p>
          </details>

          <details class="exp">
            <summary><strong>Autopilot Health & Readiness (Graph)</strong><span class="muted"> - enrollment failures, profile drift, CSV/HTML report</span></summary>
            <pre><code class="language-powershell"># Requires: Microsoft.Graph.Beta (for Intune Autopilot endpoints)
# Install-Module Microsoft.Graph.Beta -Scope CurrentUser
Import-Module Microsoft.Graph.Beta.DeviceManagement
Connect-MgGraph -Scopes "DeviceManagementManagedDevices.Read.All, DeviceManagementServiceConfig.Read.All"

$resp = Invoke-MgGraphRequest -Method GET -Uri \
  'https://graph.microsoft.com/beta/deviceManagement/windowsAutopilotDeviceIdentities?
  $select=deviceManufacturer,deviceModel,groupTag,azureActiveDirectoryDeviceId,enrollmentState,
          lastContactedDateTime,enrollmentFailureDetails'

$rows = $resp.value | ForEach-Object {
  [pscustomobject]@{
    Manufacturer = $_.deviceManufacturer
    Model        = $_.deviceModel
    GroupTag     = $_.groupTag
    AADDeviceId  = $_.azureActiveDirectoryDeviceId
    Enrollment   = $_.enrollmentState
    LastSeen     = $_.lastContactedDateTime
    Failure      = $_.enrollmentFailureDetails
  }
}
$rows | Export-Csv -NoTypeInformation -Path "autopilot-readiness.csv"
Write-Host "Saved autopilot-readiness.csv" -ForegroundColor Green</code></pre>
          </details>

          <details class="exp">
            <summary><strong>Intune Compliance Drift Remediator</strong><span class="muted"> - targets BitLocker/TPM/AV failures and queues remediation</span></summary>
            <pre><code class="language-powershell"># Requires: Microsoft.Graph (device compliance & device health scripts)
Connect-MgGraph -Scopes "DeviceManagementConfiguration.ReadWrite.All, DeviceManagementManagedDevices.Read.All"

# Example: pull devices not compliant
$nonCompliant = Invoke-MgGraphRequest -Method GET -Uri \
 'https://graph.microsoft.com/v1.0/deviceManagement/managedDevices?$filter=complianceState ne \"compliant\"&$select=id,deviceName,userPrincipalName,complianceState'

$target = $nonCompliant.value | Where-Object { $_.complianceState -in @('noncompliant','unknown') }
$target | Select deviceName,userPrincipalName,complianceState | Format-Table -Auto

# Queue a remediation script (placeholder: supply your scriptId and assignment body)
$scriptId = "00000000-0000-0000-0000-000000000000"
# Invoke-MgGraphRequest -Method POST -Uri "https://graph.microsoft.com/beta/deviceManagement/deviceHealthScripts/$scriptId/assign" -Body ($assignment | ConvertTo-Json)
</code></pre>
          </details>

          <details class="exp">
            <summary><strong>Conditional Access “What‑If” tester</strong><span class="muted"> - simulate sign‑ins and summarize effective policies</span></summary>
            <pre><code class="language-powershell"># Concept: correlate sign-in logs + policy set for quick "would this require MFA?" checks
Connect-MgGraph -Scopes "Policy.Read.All, AuditLog.Read.All, Directory.Read.All"

$users = @('alice@contoso.com','bob@contoso.com')
$ips   = @('8.8.8.8','1.1.1.1')
$plat  = @('windows','ios')

$results = foreach($u in $users){ foreach($ip in $ips){ foreach($p in $plat){
  # Illustrative only; real testing requires analyzing your CA policy conditions
  [pscustomobject]@{ User=$u; IP=$ip; Platform=$p; EffectivePolicies='MFA, CompliantDevice' }
}}}
$results | Export-Csv -NoTypeInformation -Path ca-whatif.csv
</code></pre>
          </details>

          <details class="exp">
            <summary><strong>EXO Mailbox lifecycle toolkit</strong><span class="muted"> - convert to Shared, apply hold, assign retention</span></summary>
            <pre><code class="language-powershell">Import-Module ExchangeOnlineManagement
Connect-ExchangeOnline -ShowBanner:$false

$upn = Read-Host "Mailbox UPN"
Set-Mailbox -Identity $upn -Type Shared -ErrorAction SilentlyContinue
Set-Mailbox -Identity $upn -LitigationHoldEnabled:$true -RetentionComment "Offboarding hold"
Set-Mailbox -Identity $upn -RetentionPolicy "Corp-Default-Retention"
Write-Host "Mailbox converted and retention applied." -ForegroundColor Green
</code></pre>
          </details>

          <details class="exp">
            <summary><strong>SCCM → Intune app readiness report</strong><span class="muted"> - detects install types, flags detection issues, recommends order</span></summary>
            <pre><code class="language-powershell"># Input: sccm-apps.csv with Name, InstallCmd, DetectRuleType, ExitCodes
$apps = Import-Csv .\sccm-apps.csv
$report = foreach($a in $apps){
  $risk = @()
  if($a.DetectRuleType -notin 'Registry','File','MSI'){ $risk += 'Ambiguous detection' }
  if($a.InstallCmd -match 'msiexec' -and $a.ExitCodes -notmatch '0;3010'){ $risk += 'Missing reboot code 3010' }
  [pscustomobject]@{ Name=$a.Name; Risks=($risk -join '; '); SuggestedOrder=(if($a.InstallCmd -match 'vc\+\+|dotnet' ){1}else{5}) }
}
$report | Sort SuggestedOrder, Name | Export-Csv -NoTypeInformation intune-app-readiness.csv
</code></pre>
          </details>

          <details class="exp">
            <summary><strong>Azure RBAC baseliner (Bicep/Terraform)</strong><span class="muted"> - least‑privilege role assignments across RGs</span></summary>
            <pre><code class="language-bicep">targetScope = 'subscription'
param rgNames array = [ 'rg-prod-app', 'rg-prod-data' ]
param principalId string // Entra group objectId e.g. Ops Team
resource roleDef 'Microsoft.Authorization/roleDefinitions@2022-04-01' existing = {
  name: 'b24988ac-6180-42a0-ab88-20f7382dd24c' // Contributor
}
module assignRG 'br/public:authorization/role-assignment:1.0.0' = [for rgName in rgNames: {
  name: 'ra-' + rgName
  params: {
    principalId: principalId
    scope: subscriptionResourceId('Microsoft.Resources/resourceGroups', rgName)
    roleDefinitionId: roleDef.id
  }
}]
</code></pre>
            <pre><code class="language-hcl">variable "rg_names" { type = list(string) }
variable "principal_object_id" { type = string }
provider "azurerm" { features {} }
data "azurerm_subscription" "current" {}
resource "azurerm_role_assignment" "ops_contrib" {
  for_each             = toset(var.rg_names)
  scope                = "/subscriptions/${data.azurerm_subscription.current.subscription_id}/resourceGroups/${each.value}"
  role_definition_name = "Contributor"
  principal_id         = var.principal_object_id
}
</code></pre>
          </details>

        </article>

        <article class="item">
          <h3>Python</h3>
          <p class="muted">Utilities for extraction, scraping with safety, and quick reports.</p>

          <details class="exp">
            <summary><strong>HTML → CSV extractor</strong><span class="muted"> - parse tables to DataFrame/CSV</span></summary>
            <pre><code class="language-python">from bs4 import BeautifulSoup
import pandas as pd

html = open("input.html", "r", encoding="utf-8").read()
soup = BeautifulSoup(html, "html.parser")

rows = []
for tr in soup.select("table tr"):
    cells = [c.get_text(strip=True) for c in tr.find_all(["th","td"])]
    if cells:
        rows.append(cells)

# assume first row is header
header, *data = rows

# normalize row length
width = len(header)
fixed = [r + [None]*(width-len(r)) if len(r) < width else r[:width] for r in data]

df = pd.DataFrame(fixed, columns=header)
df.to_csv("output.csv", index=False)
print("Saved output.csv")
</code></pre>
          </details>

          <details class="exp">
            <summary><strong>Polite scraper w/ backoff</strong><span class="muted"> - respects robots.txt and rate limits</span></summary>
            <pre><code class="language-python">import time, random, requests
from urllib.parse import urljoin
from urllib import robotparser

BASE = "https://example.com/"
AGENT = "jf-portfolio-bot/1.0"

rp = robotparser.RobotFileParser()
rp.set_url(urljoin(BASE, "robots.txt"))
rp.read()

session = requests.Session()
session.headers.update({"User-Agent": AGENT})

urls = [urljoin(BASE, path) for path in ["/docs/1", "/docs/2", "/docs/3"]]

for u in urls:
    if not rp.can_fetch(AGENT, u):
        print("Blocked by robots:", u)
        continue
    delay = 1.0
    for attempt in range(5):
        try:
            r = session.get(u, timeout=20)
            r.raise_for_status()
            print("Fetched", u, len(r.content), "bytes")
            break
        except requests.RequestException as e:
            print("Retry", attempt+1, "for", u, e)
            time.sleep(delay)
            delay = min(delay * 2, 30) + random.uniform(0, 1)
</code></pre>
          </details>

          <details class="exp">
            <summary><strong>Docx report generator</strong><span class="muted"> - quick status report to .docx</span></summary>
            <pre><code class="language-python">from docx import Document
from datetime import datetime

report = Document()
report.add_heading("Weekly Status", level=1)

ts = datetime.now().strftime("%Y-%m-%d %H:%M")
report.add_paragraph(f"Generated: {ts}")

sections = {
    "Highlights": ["Completed M365 rollout phase", "Patched 12 servers"],
    "Risks": ["License renewal due in 14 days"],
    "Next": ["Pilot Intune Autopilot", "Decommission legacy file server"],
}

for title, items in sections.items():
    report.add_heading(title, level=2)
    for it in items:
        report.add_paragraph(it, style="List Bullet")

report.save("weekly-status.docx")
print("Saved weekly-status.docx")
</code></pre>
          </details>
        </article>
      </div>
    </section>

    <section class="section panel">
      <a class="btn" href="index.html" title="Back to main">← Back to Portfolio</a>
    </section>
  </main>

  <footer>
    <p>© <span id="y"></span> James Farmer</p>
  </footer>
  <script>document.getElementById('y').textContent=new Date().getFullYear()</script>
  <style>
    /* expandable styling */
    details.exp{border:1px solid color-mix(in oklab,var(--muted), transparent 70%);border-radius:14px;padding:.6rem .8rem;margin:.7rem 0;background:color-mix(in oklab,var(--panel), black 6%)}
    details.exp[open]{box-shadow:0 0 0 6px var(--ring)}
    details.exp summary{cursor:pointer;display:flex;align-items:center;gap:.5rem}
    details.exp summary::marker{display:none}
    details.exp summary::-webkit-details-marker{display:none}
    details.exp pre{overflow:auto;background:rgba(0,0,0,.35);border-radius:10px;padding:.8rem;margin:.7rem 0 0 0}
    code{font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; font-size:.92rem}
  </style>
</body>
</html>
